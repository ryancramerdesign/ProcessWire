$(document).ready(function(){var b=function(g){var f=$(this).parent("label").parent("li");if(f.is(".InputfieldRepeaterNewItem")){var c=f.parent().parent().find(".InputfieldRepeaterAddItem").children("input");c.attr("value",parseInt(c.attr("value")-1));f.remove()}else{var d=f.find(".InputfieldRepeaterDelete");if(d.is(":checked")){d.removeAttr("checked");f.children("label").removeClass("ui-state-error").addClass("ui-state-default");if(f.is(".InputfieldStateCollapsed")){f.toggleClass("InputfieldStateCollapsed",100)}f.removeClass("InputfieldRepeaterDeletePending")}else{d.attr("checked","checked");f.children("label").removeClass("ui-state-default").addClass("ui-state-error");if(!f.is(".InputfieldStateCollapsed")){f.toggleClass("InputfieldStateCollapsed",100)}f.addClass("InputfieldRepeaterDeletePending")}}g.stopPropagation()};var a=$("<span class='ui-icon ui-icon-trash InputfieldRepeaterTrash'>Delete</span>").css("display","block").click(b);$("input.InputfieldRepeaterDelete").parents(".InputfieldCheckbox").hide();$(".InputfieldRepeater .InputfieldFieldset > .ui-widget-header, .InputfieldRepeater .InputfieldFieldset > .InputfieldHeader").addClass("ui-state-default").prepend("<span class='ui-icon ui-icon-arrowthick-2-n-s InputfieldRepeaterDrag'></span>").prepend(a.clone(true));$(".InputfieldRepeaterDrag").hover(function(){$(this).parent("label").addClass("ui-state-focus")},function(){$(this).parent("label").removeClass("ui-state-focus")});$(".InputfieldRepeaterTrash").hover(function(){var c=$(this).parent("label");if(!c.parent().is(".InputfieldRepeaterDeletePending")){c.addClass("ui-state-error")}},function(){var c=$(this).parent("label");if(!c.parent().is(".InputfieldRepeaterDeletePending")){c.removeClass("ui-state-error")}});$(".InputfieldRepeaterAddLink").click(function(){var j=$(this).parent("p").prev("ul.Inputfields");var d=j.children(".InputfieldRepeaterReady");if(d.size()>0){d=d.slice(0,1);d.hide();d.removeClass("InputfieldRepeaterReady");d.find("input.InputfieldRepeaterDisabled").remove();d.find("input.InputfieldRepeaterPublish").attr("value",1);d.slideDown("fast",function(){$(window).resize()});d.children(".ui-widget-content, .InputfieldContent").effect("highlight",{},1000);return false}var f=j.children(".InputfieldRepeaterNewItem");var e=$(this).parent().children("input");var k=f.size();if(k>1){f=f.slice(0,1)}var h=f.clone(true);var l=h.children("label");var g=l.html();var i=g.substring(g.lastIndexOf("#")+1);g=g.replace(/#[0-9]+/,"#"+((i-1)+k));l.html(g);var c=h.attr("id")+"_";while($("#"+c).size()>0){c+="_"}h.attr("id",c);j.append(h);h.css("display","block");h.find(".InputfieldRepeaterTrash").click(b);e.attr("value",k);return false});$(".InputfieldRepeater > div > .Inputfields").sortable({items:"> li:not(.InputfieldRepeaterNewItem):not(.InputfieldRepeaterReady)",axis:"y",handle:".InputfieldRepeaterDrag",start:function(d,c){c.item.find(".ui-widget-header, .InputfieldHeader").addClass("ui-state-highlight");c.item.find(".InputfieldTinyMCE textarea").each(function(){tinyMCE.execCommand("mceRemoveControl",false,$(this).attr("id"))})},stop:function(d,c){c.item.find(".ui-widget-header, .InputfieldHeader").removeClass("ui-state-highlight");$(this).children().each(function(e){$(this).find(".InputfieldRepeaterSort").slice(0,1).attr("value",e)});c.item.find(".InputfieldTinyMCE textarea").each(function(){tinyMCE.execCommand("mceAddControl",false,$(this).attr("id"))})}})});