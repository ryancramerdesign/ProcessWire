function InputfieldImage(u){var k=null;var b={file:"",item:null,edit:null};var E={type:"image",closeOnContentClick:true,closeBtnInside:true};var c=null;var q=[];function r(){var L=window.File&&window.FileList&&window.FileReader;var K=u(".InputfieldAllowAjaxUpload").length>0;var M=u("#PageIDIndicator").length>0;return(L&&(M||K))}function x(M,K,L){K||(K=250);var N,O;return function(){var R=L||this;var Q=+new Date(),P=arguments;if(N&&Q<N+K){clearTimeout(O);O=setTimeout(function(){N=Q;M.apply(R,P)},K)}else{N=Q;M.apply(R,P)}}}function f(L,K){return !K}function A(L){if(L.hasClass("ui-sortable")){L.sortable("destroy");L.children("li").each(function(O){var N=u(this).find("input.InputfieldFileSort");N.val(O)})}var M;var K={items:"> .gridImage",start:function(P,O){var N=D(L.closest(".Inputfield"),"size");O.placeholder.append(u("<div/>").css({display:"block",height:N+"px",width:N+"px"}));M=window.setTimeout(function(){F(L,null)},100);L.addClass("InputfieldImageSorting")},stop:function(O,N){$this=u(this);if(M!==null){N.item.find(".InputfieldImageEdit__edit").click();clearTimeout(M)}$this.children("li").each(function(Q){var P=u(this).find(".InputfieldFileSort");if(P.val()!=Q){P.val(Q).change()}});L.removeClass("InputfieldImageSorting")},cancel:".InputfieldImageEdit"};L.sortable(K)}function o(L){var K=u.extend(true,{},E);K.callbacks={elementParse:function(M){var N=u(M.el).attr("data-original");if(typeof N=="undefined"||!N){N=u(M.el).attr("src")}M.src=N}};K.gallery={enabled:true};L.find("img").magnificPopup(K)}function s(L){var K=u.extend(true,{},E);K.callbacks={elementParse:function(M){M.src=u(M.el).attr("src")}};K.gallery={enabled:false};L.find("img").magnificPopup(K)}function B(K){return K.find(".InputfieldImageEdit--active")}function t(K){return u("#"+K.find(".InputfieldImageEdit__edit").attr("data-current"))}function C(M){var K=M.is(":checked");var L=M.parents(".gridImages").find(".gridImage__deletebox");if(K){L.prop("checked","checked").change()}else{L.removeAttr("checked").change()}}function I(L){if(typeof L=="undefined"){var K=u(".gridImages")}else{var K=L.find(".gridImages")}K.each(function(){var M=u(this),N=B(M);if(N.length){i(t(N),N)}})}function v(Q){var M=[];var P=[];var O=0,K=0;var N;if(typeof Q=="undefined"){N=u(".InputfieldImage.Inputfield")}else{N=Q}N.removeClass("InputfieldImageNarrow");N.each(function(){var S=u(this);var T=S.width();if(T<1){return}if(T<=500){M[O]=S;O++}});for(var R=0;R<O;R++){var L=M[R];L.addClass("InputfieldImageNarrow")}}function g(){I();v()}function n(K){if(K.is(":checked")){K.parents(".ImageOuter").addClass("gridImage--delete")}else{K.parents(".ImageOuter").removeClass("gridImage--delete")}}function d(N,K){if(N.closest(".InputfieldImageEditAll").length){return}var M=K.find(".InputfieldImageEdit__image");var P=N.find("img");M.attr({src:P.attr("data-original"),"data-original":P.attr("data-original"),alt:P.attr("alt")});var L=u.extend(true,{},E);L.callbacks={elementParse:function(Q){Q.src=u(Q.el).attr("data-original")}};L.gallery={enabled:true};K.attr("id","edit-"+N.attr("id"));var O=K.parents(".gridImages").find(".gridImage").not(N).find("img").add(M).magnificPopup(L);K.find(".InputfieldImageEdit__edit").attr("data-current",N.attr("id")).append(N.find(".ImageData").children().not(".InputfieldFileSort"))}function m(K){$inputArea=K.find(".InputfieldImageEdit__edit");if($inputArea.children().not(".InputfieldFileSort").length){var L=$inputArea.children();u("#"+$inputArea.attr("data-current")).find(".ImageData").append(L)}}function F(M,L){var K;if(M){K=M.find(".InputfieldImageEdit--active")}else{if(L){K=u(".InputfieldImageEdit--active").not(L.find(".InputfieldImageEdit--active"))}else{K=u(".InputfieldImageEdit--active")}}if(K.length){m(K);K.removeClass("InputfieldImageEdit--active").removeAttr("id");u("#"+K.attr("data-for")).removeClass("gridImageEditing")}u(".InputfieldImageEdit__replace").removeClass("InputfieldImageEdit__replace")}function i(N,L){if(!N||!N.length){return}var K=N.parent().children().not(".InputfieldImageEdit");var O=0;var P=false;var Q=null;K.each(function(){if(Q){return}var R=u(this);var S=R.offset().top;if(P&&S!=O){Q=R}else{if(R.attr("id")==N.attr("id")){P=true}}O=S});if(Q){L.insertBefore(Q)}else{L.insertAfter(K.eq(K.length-1))}var M=L.find(".InputfieldImageEdit__arrow");if(M.length){M.css("left",N.position().left+(N.outerWidth()/2)+"px")}}function w(){u(window).resize(x(g,200));u(document).on("click dblclick",".gridImage__trash",function(K){var L=u(this).find("input");L.prop("checked",f).change();if(K.type=="dblclick"){C(L);K.preventDefault();K.stopPropagation()}});u(document).on("change",".gridImage__deletebox",function(){n(u(this))});u(document).on("click",".gridImage__edit",function(N){var L=u(this).closest(".gridImage");if(!L.length){return}if(L.closest(".InputfieldImageEditAll").length){return false}var M=L.closest(".gridImages");var K=M.find(".InputfieldImageEdit");if(L.hasClass("gridImageEditing")){K.find(".InputfieldImageEdit__close").click()}else{i(L,K);m(K);d(L,K);K.addClass("InputfieldImageEdit--active").attr("data-for",L.attr("id"));M.find(".gridImageEditing").removeClass("gridImageEditing");L.addClass("gridImageEditing")}}).on("click",".InputfieldImageEditAll img",function(M){M.stopPropagation();M.preventDefault();u.magnificPopup.close();var K=u.extend(true,{},E);var L=u(this);K.items={src:L.attr("data-original"),title:L.attr("alt")};u.magnificPopup.open(K);return true});u(document).on("click",function(L){var K=u(L.target);if(K.closest(".InputfieldImageEdit").length){F(null,K.parents(".gridImages"))}else{if(K.is("input")&&K.closest(".InputfieldImageEditAll").length){K.focus().one("blur",function(){K.closest(".gridImages").sortable("enable")});K.closest(".gridImages").sortable("disable")}else{if(K.closest(".gridImage__inner").length){F(null,K.parents(".gridImages"))}else{if(K.closest(".mfp-container").length){return}else{if(K.closest(".ui-dialog").length){return}else{if(K.is(".mfp-close")){return}else{F(null,null)}}}}}}});u(document).on("click",".InputfieldImageEdit__close",function(K){F(u(this).parents(".gridImages"),null)});u(document).on("change",".InputfieldImage",function(){u(this).find(".InputfieldImageButtonCrop:not(.pw-modal-dblclick)").addClass("pw-modal-dblclick ui-state-disabled")}).on("click",".InputfieldImageButtonCrop.ui-state-disabled",function(M){var L=u(this);var K=L.closest(".gridImages");if(!K.hasClass("gridImagesAlerted")){alert(ProcessWire.config.InputfieldImage.labels.changes);K.addClass("gridImagesAlerted")}setTimeout(function(){L.removeClass("ui-state-active")},500);return false});u(".ImagesGrid").on("click","button.pw-modal",function(K){K.preventDefault()});p();v()}function p(){u(document).on("click",".InputfieldImageEdit__name",function(M){var K=u(this).children("span");var N=K.closest(".gridImage, .InputfieldImageEdit").find(".InputfieldFileRename");var L=K.closest(".gridImages");L.sortable("disable");N.val(K.text());K.on("keypress",function(O){if(O.which==13){K.blur();return false}return true});K.attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false");K.focus().on("blur",function(){var O=u(this).text();if(u.trim(O).length<1){K.text(N.val())}else{if(O!=N.val()){N.val(O).change();L.closest(".Inputfield").trigger("change")}}K.off("keypress");L.sortable("enable")})})}function l(K,L){L=Math.floor(L);K.find(".gridImage__overflow").each(function(){var M=100-L;u(this).css("width",L+"%");u(this).siblings(".ImageData").css("width",M+"%")});e(K,"listSize",L)}function j(O,K,M){if(!K){return}var L=K+"px";var N=O.find(".gridImages");if(typeof M=="undefined"||M==null){M=N.attr("data-ragged")?true:false}if(M){N.attr("data-ragged",1)}else{N.removeAttr("data-ragged")}N.find(".gridImage__overflow").each(function(){h(u(this),K,M)});N.find(".gridImage__edit, .gridImage__resize").css("line-height",L);N.attr("data-size",K);e(O,"size",K);if(q.length){setTimeout(function(){while(q.length){var P=q.pop();h(P,K,M)}},150)}}function h(M,L,O){if(M.hasClass("gridImage__overflow")){var N=M.children("img")}else{if(M.is("img")){var N=M;M=N.closest(".gridImage__overflow")}else{return}}if(!L){N.removeAttr("width").removeAttr("height");M.width("auto").height("auto");return}var K=N.width();var P=N.height();if(O){N.attr("height",L).removeAttr("width")}else{if(K>=P){N.attr("height",L).removeAttr("width")}else{if(P>K){N.attr("width",L).removeAttr("height")}else{N.removeAttr("width").attr("height",L)}}}var K=N.width();if(K){M.css({width:(O?K+"px":L+"px"),height:L+"px"})}else{var Q=M.attr("data-tries");if(!Q){Q=0}if(typeof Q=="undefined"){Q=0}Q=parseInt(Q);if(Q>3){M.css({width:L+"px",height:L+"px"})}else{q.push(M);M.attr("data-tries",Q+1)}}}function z(L){if(L.find(".InputfieldImageListToggle").length){return}var O=u("<a class='InputfieldImageListToggle' href='list'></a>").append("<i class='fa fa-th-list'></i>");var Q=u("<a class='InputfieldImageListToggle' href='left'></a>").append("<i class='fa fa-tasks'></i>");var K=u("<a class='InputfieldImageListToggle' href='grid'></a>").append("<i class='fa fa-th'></i>");var P="InputfieldImageListToggle--active";var N="";var M=function(V){var U=u(this);var T=U.closest(".Inputfield");var R=U.attr("href");var S;U.parent().children("."+P).removeClass(P);U.addClass(P);if(R=="list"){if(!T.hasClass("InputfieldImageEditAll")){T.find(".InputfieldImageEdit--active .InputfieldImageEdit__close").click();T.addClass("InputfieldImageEditAll")}S=D(T,"listSize");l(T,S);e(T,"mode","list")}else{if(R=="left"){T.removeClass("InputfieldImageEditAll");S=D(T,"size");j(T,S,true);e(T,"mode","left");I()}else{if(R=="grid"){T.removeClass("InputfieldImageEditAll");S=D(T,"size");j(T,S,false);e(T,"mode","grid")}}}A(T.find(".gridImages"));U.blur();return false};O.click(M);Q.click(M);K.click(M);if(L.hasClass("InputfieldImage")){L.find(".InputfieldHeader").append(O).append(Q).append(K);N=D(L,"mode")}else{u(".InputfieldImage .InputfieldHeader",L).append(O).append(Q).append(K)}if(N=="list"){O.click()}else{if(N=="left"){Q.click()}else{}}}function y(P){var M=P.children(".InputfieldHeader");if(M.children(".InputfieldImageSizeSlider").length){return}var O=P.find(".gridImages");var L=O.attr("data-gridsize");var N=L/2;var K=L*2;var Q=u('<span class="InputfieldImageSizeSlider"></span>');M.append(Q);Q.slider({min:N,max:K,value:D(P,"size"),range:"min",slide:function(T,V){var U=V.value;var W=15;var X=Math.floor(L/W);var R=U-N;var S=Math.floor(W+(R/X));if(P.hasClass("InputfieldImageEditAll")){e(P,"size",U);l(P,S)}else{e(P,"listSize",S);j(P,U)}},start:function(R,S){if(P.find(".InputfieldImageEdit:visible").length){P.find(".InputfieldImageEdit__close").click()}},stop:function(R,S){I(P)}})}function e(L,O,N){var M=D(L);var P=L.attr("id");var K=P?P.replace("wrap_Inputfield_",""):"";if(!K.length||typeof N=="undefined"){return}if(M[K][O]==N){return}M[K][O]=N;u.cookie("InputfieldImage",M);c=M}function D(L,O){if(c&&typeof O=="undefined"){return c}var P=L.attr("id");var K=P?P.replace("wrap_Inputfield_",""):"na";var N=c?c:u.cookie("InputfieldImage");var M=null;if(!N){var N={}}if(typeof N[K]=="undefined"){N[K]={}}if(typeof N[K].size=="undefined"){N[K].size=parseInt(L.find(".gridImages").attr("data-size"))}if(typeof N[K].listSize=="undefined"){N[K].listSize=23}if(typeof N[K].mode=="undefined"){N[K].mode="grid"}if(c==null){c=N}if(typeof O=="undefined"){M=N}else{if(O===true){M=N[K]}else{if(typeof N[K][O]!="undefined"){M=N[K][O]}}}return M}function a(O){if(O.hasClass("InputfieldStateCollapsed")){return}var P=parseInt(O.find(".InputfieldImageMaxFiles").val());var N=O.find(".gridImages");var M=D(O,"size");var Q=D(O,"mode");var L=Q=="left"?true:false;if(!M){M=N.attr("data-gridsize")}M=parseInt(M);j(O,M,L);if(O.hasClass("InputfieldImageEditAll")||Q=="list"){var K=D(O,"listSize");l(O,K)}if(!O.hasClass("InputfieldImageInit")){O.addClass("InputfieldImageInit");if(O.hasClass("InputfieldRenderValueMode")){return o(O)}else{if(P==1){O.addClass("InputfieldImageMax1");s(O)}else{A(N)}}z(O);y(O)}v(O)}function H(){u("body").addClass("ie-no-drop");u(".InputfieldImage.InputfieldFileMultiple").each(function(){var L=u(this),N=parseInt(L.find(".InputfieldFileMaxFiles").val()),K=L.find(".gridImages"),M=L.find(".InputfieldImageUpload");M.on("change","input[type=file]",function(){var R=u(this),P=R.parent(".InputMask");if(R.val().length>1){P.addClass("ui-state-disabled")}else{P.removeClass("ui-state-disabled")}if(R.next("input.InputfieldFile").length>0){return}var O=K.children("li").length+M.find("input[type=file]").length+1;if(N>0&&O>=N){return}M.find(".InputMask").not(":last").each(function(){var S=u(this);if(S.find("input[type=file]").val()<1){S.remove()}});var Q=P.clone().removeClass("ui-state-disabled");Q.children("input[type=file]").val("");Q.insertAfter(P)})})}function J(M){var L;if(M.length>0){L=M.find(".InputfieldImageUpload")}else{L=u(".InputfieldImageUpload")}L.each(function(P){var Q=u(this);var O=Q.closest(".InputfieldContent");if(Q.hasClass("InputfieldImageInitUpload")){return}N(O,P);Q.addClass("InputfieldImageInitUpload")});function N(W,ah){var V=W.parents("form");var R=V.attr("action");R+=(R.indexOf("?")>-1?"&":"?")+"InputfieldFileAjax=1";var al=V.find("input._post_token");var U=al.attr("name");var Z=al.val();var Y=W.find(".InputfieldImageErrors").first();var Q=W.find(".InputfieldImageUpload").data("fieldname");Q=Q.slice(0,-2);var ag=W.closest(".Inputfield.InputfieldImage");var ak=W.find(".InputfieldImageUpload").data("extensions").toLowerCase();var af=W.find(".InputfieldImageUpload").data("maxfilesize");var X=W.find("input[type=file]").get(0);var P=W.find(".gridImages");var ai=P.get(0);var ab=P.data("gridsize");var ac=null;var aa=parseInt(W.find(".InputfieldImageMaxFiles").val());aj(W);if(aa!=1){ae(P)}P.children().addClass("InputfieldFileItemExisting");function T(an,am){if(typeof am!=="undefined"){an="<b>"+am+":</b> "+an}return"<li>"+an+"</li>"}function O(an){var am=new String(an).substring(an.lastIndexOf("/")+1);if(am.lastIndexOf(".")!=-1){am=am.substring(0,am.lastIndexOf("."))}return am}function aj(am){if(am.hasClass("InputfieldImageDropzoneInit")){return}var an=am.get(0);an.addEventListener("dragleave",function(){am.removeClass("ui-state-hover")},false);an.addEventListener("dragenter",function(){am.addClass("ui-state-hover")},false);an.addEventListener("dragover",function(ao){if(!am.is("ui-state-hover")){am.addClass("ui-state-hover")}ao.preventDefault();ao.stopPropagation();return false},false);an.addEventListener("drop",function(ao){ad(ao.dataTransfer.files);am.removeClass("ui-state-hover");ao.preventDefault();ao.stopPropagation();return false},false);am.addClass("InputfieldImageDropzoneInit")}function ae(at){var aw=null;var av=false;var am=null;function ap(ay){var aC=ay.offset();var az=ay.width();var ax=ay.height();var aB=aC.left+az/2;var aA=aC.top+ax/2;return{clientX:aB,clientY:aA}}function ar(){return at.find(".InputfieldImageEdit--active").length>0}function aq(ay){if(ar()){return}ay.preventDefault();ay.stopPropagation();av=false;if(aw==null){var ax=at.attr("data-size")+"px";var az=u("<div/>").addClass("gridImage__overflow");if(at.closest(".InputfieldImageEditAll").length){az.css({width:"100%",height:ax})}else{az.css({width:ax,height:ax})}aw=u("<li/>").addClass("ImageOuter gridImage gridImagePlaceholder").append(az);at.append(aw)}var aA=ap(aw);aw.simulate("mousedown",aA)}function au(ax){if(ar()){return}ax.preventDefault();ax.stopPropagation();av=false;if(aw==null){return}var ay={clientX:ax.originalEvent.clientX,clientY:ax.originalEvent.clientY};aw.simulate("mousemove",ay)}function ao(ax){if(ar()){return}ax.preventDefault();ax.stopPropagation();if(aw==null){return false}av=true;if(am){clearTimeout(am)}am=setTimeout(function(){if(!av||aw==null){return}aw.remove();aw=null},1000)}function an(ax){if(ar()){return}av=false;var ay={clientX:ax.clientX,clientY:ax.clientY};aw.simulate("mouseup",ay);k=aw.next(".gridImage");aw.remove();aw=null}if(at.length&&!at.hasClass("gridImagesInitDropInPlace")){at.on("dragenter",aq);at.on("dragover",au);at.on("dragleave",ao);at.on("drop",an);at.addClass("gridImagesInitDropInPlace")}}function S(aH){var aF=ProcessWire.config.InputfieldImage.labels;var at=parseInt(aH.size/1024,10)+"&nbsp;kB";var aG='<div class="gridImage__tooltip"><table><tbody><tr><th>'+aF.dimensions+'</th><td class="dimensions">'+aF.na+"</td></tr><tr><th>"+aF.filesize+"</th><td>"+at+"</td></tr><tr><th>"+aF.variations+"</th><td>0</td></tr></tbody></table></div>";var aJ=u('<li class="gridImage gridImageUploading"></li>'),aC=u(aG),av=u('<div class="gridImage__overflow"></div>'),am=u('<div class="ImageData"></div>'),az=u("<div class='gridImage__hover'><div class='gridImage__inner'></div></div>"),aB=u("<progress class='gridImage__progress' min='-1' max='100' value='0'></progress>"),aE=u('<a class="gridImage__edit" title="'+aH.name+'"><span>&nbsp;</span></a>'),aD=u('<div class="gridImage__resize"><i class="fa fa-spinner fa-spin fa-2x fa-fw"></i></div>'),an,ax,aI,ay=URL.createObjectURL(aH),ao=ag.find(".gridImages"),aq=aa==1,aA=D(ag,"size"),ar=D(ag,"listSize"),ap=ag.hasClass("InputfieldImageEditAll"),aw=u('<img height="'+aA+'" alt="">');av.append(aw);az.find(".gridImage__inner").append(aE);az.find(".gridImage__inner").append(aD.css("display","none"));az.find(".gridImage__inner").append(aB);am.append(u('<h2 class="InputfieldImageEdit__name">'+aH.name+'</h2><span class="InputfieldImageEdit__info">'+at+"</span>"));if(ap){av.css("width",ar+"%");am.css("width",(100-ar)+"%")}else{av.css({width:aA+"px",height:aA+"px"})}aJ.append(aC).append(av).append(az).append(am);aw.attr({src:ay,"data-original":ay});img=new Image();img.addEventListener("load",function(){aC.find(".dimensions").html(this.width+"&nbsp;&times;&nbsp;"+this.height);var aK=Math.min(this.width,this.height)/aA;aw.attr({width:this.width/aK,height:this.height/aK})},false);img.src=ay;ax=new XMLHttpRequest();ax.upload.addEventListener("progress",function(aK){if(!aK.lengthComputable){return}aB.attr("value",parseInt((aK.loaded/aK.total)*100));aD.css("display","block")},false);ax.addEventListener("load",function(){var aL=u.parseJSON(ax.responseText),aO=aL.length>1;if(aL.error!==undefined){aL=[aL]}for(var aQ=0;aQ<aL.length;aQ++){var aN=aL[aQ];if(aN.error){Y.append(T(aN.message));continue}var aK=null;var aM=u(aN.markup).hide();var aP=W.find("input[type=file]");if(aP.val()){aP.replaceWith(aP.clone(true))}if(aN.overwrite){aK=ao.children("#"+aM.attr("id"))}if(aa==1||aN.replace){aK=ao.children(".gridImage:eq(0)")}else{if(b.item&&aL.length==1){aK=b.item}}if(aK&&aK.length){aK.replaceWith(aM)}else{if(k&&k.length){k.before(aM);k=aM}else{if(aQ===0){aJ.replaceWith(aM)}else{ao.append(aM)}}}if(ap){aM.find(".gridImage__overflow").css("width",ar+"%")}else{aM.find(".gridImage__overflow").css({height:aA+"px",width:aA+"px"});aM.find("img").hide()}aM.fadeIn(150,function(){aM.find("img").fadeIn();if(ap){l(ag,ar)}else{j(ag,aA)}}).css("display","");aM.addClass("InputfieldFileItemExisting");if(aK&&aK.length){aM.effect("highlight",500)}if(aJ.length){aJ.remove()}if(b.item&&aa!=1){aM.find(".gridImage__edit").click();aM.find(".InputfieldFileReplace").val(b.file)}b.file="";b.item=null;b.edit=null}if(ac){clearTimeout(ac)}k=null;ac=setTimeout(function(){if(aa!=1){A(ao)}else{s(ag)}ao.trigger("AjaxUploadDone")},500);ag.trigger("change").removeClass("InputfieldFileEmpty")},false);if(b.edit){b.edit.find(".InputfieldImageEdit__close").click()}else{if(ag.find(".InputfieldImageEdit:visible").length){ag.find(".InputfieldImageEdit__close").click()}}ax.open("POST",R,true);ax.setRequestHeader("X-FILENAME",encodeURIComponent(aH.name));ax.setRequestHeader("X-FIELDNAME",Q);ax.setRequestHeader("Content-Type","application/octet-stream");ax.setRequestHeader("X-"+U,Z);ax.setRequestHeader("X-REQUESTED-WITH","XMLHttpRequest");ax.send(aH);if(b.item){b.item.replaceWith(aJ);b.item=aJ}else{if(k&&k.length){k.before(aJ)}else{ao.append(aJ)}}I();ag.trigger("change");var au=ag.find(".InputfieldFileItem").length;if(au==1){ag.removeClass("InputfieldFileEmpty").removeClass("InputfieldFileMultiple").addClass("InputfieldFileSingle")}else{if(au>1){ag.removeClass("InputfieldFileEmpty").removeClass("InputfieldFileSingle").addClass("InputfieldFileMultiple")}}}function ad(aq){var an=function(av){return parseInt(av/1024,10)};if(typeof aq==="undefined"){ai.innerHTML="No support for the File API in this web browser";return}for(var ao=0,am=aq.length;ao<am;ao++){var au=aq[ao].name.split(".").pop().toLowerCase();var ap;if(ak.indexOf(au)==-1){ap=au+" is a invalid file extension, please use one of:  "+ak;Y.append(T(ap,aq[ao].name))}else{if(aq[ao].size>af&&af>2000000){var at=an(aq[ao].size),ar=an(af);ap="Filesize "+at+" kb is too big. Maximum allowed is "+ar+" kb";Y.append(T(ap,aq[ao].name))}else{S(aq[ao])}}if(aa==1){break}}}X.addEventListener("change",function(am){ad(this.files);am.preventDefault();am.stopPropagation();this.value=""},false)}function K(){var O=".InputfieldImageEdit__imagewrapper img";u(document).on("dragenter",O,function(){var R=u(this);if(R.closest(".InputfieldImageMax1").length){return}var S=R.attr("src");var P=R.closest(".InputfieldImageEdit");var Q=R.closest(".InputfieldImageEdit__imagewrapper");Q.addClass("InputfieldImageEdit__replace");b.file=new String(S).substring(S.lastIndexOf("/")+1);b.item=u("#"+P.attr("data-for"));b.edit=P}).on("dragleave",O,function(){var Q=u(this);if(Q.closest(".InputfieldImageMax1").length){return}var P=Q.closest(".InputfieldImageEdit__imagewrapper");P.removeClass("InputfieldImageEdit__replace");b.file="";b.item=null;b.edit=null})}K()}function G(){u(".InputfieldImage.Inputfield").each(function(){a(u(this))});w();if(r()){J("")}else{H()}u(document).on("reloaded",".InputfieldImage",function(){var K=u(this);a(K);J(K)}).on("wiretabclick",function(M,L,K){L.find(".InputfieldImage").each(function(){a(u(this))})}).on("opened",".InputfieldImage",function(){a(u(this))})}G()}jQuery(document).ready(function(a){InputfieldImage(a)});