window.ToolbarConfigurator={};(function(){function a(){this.instanceid="fte"+CKEDITOR.tools.getNextId();this.textarea=new CKEDITOR.dom.element("textarea");this.textarea.setAttributes({id:this.instanceid,name:this.instanceid,contentEditable:!0});this.editorInstance=this.buttons=null}ToolbarConfigurator.FullToolbarEditor=a;a.prototype.init=function(c){var d=this;document.body.appendChild(this.textarea.$);CKEDITOR.replace(this.instanceid);this.editorInstance=CKEDITOR.instances[this.instanceid];this.editorInstance.once("configLoaded",function(b){var e=b.editor.config;delete e.removeButtons;delete e.toolbarGroups;delete e.toolbar;ToolbarConfigurator.AbstractToolbarModifier.extendPluginsConfig(e);b.editor.once("loaded",function(){d.buttons=a.toolbarToButtons(d.editorInstance.toolbar);d.buttonsByGroup=a.groupButtons(d.buttons);d.buttonNamesByGroup=d.groupButtonNamesByGroup(d.buttons);b.editor.container.hide();"function"===typeof c&&c(d.buttons)})})};a.prototype.groupButtonNamesByGroup=function(c){var e=this,c=a.groupButtons(c),f;for(f in c){c[f]=a.map(c[f],function(d){return e.getCamelCasedButtonName(d.name)})}return c};a.prototype.getGroupByName=function(e){for(var f=this.editorInstance.config.toolbarGroups||this.getFullToolbarGroupsConfig(),g=f.length,h=0;h<g;h+=1){if(f[h].name===e){return f[h]}}return null};a.prototype.getCamelCasedButtonName=function(c){var e=this.editorInstance.ui.items,f;for(f in e){if(e[f].name==c){return f}}return null};a.prototype.getFullToolbarGroupsConfig=function(h){for(var h=!0===h?!0:!1,i=[],m=this.editorInstance.toolbar,n=m.length,k=0;k<n;k+=1){var l=m[k],j={};"string"!=typeof l.name?h&&i.push("/"):(j.name=l.name,l.groups&&(j.groups=Array.prototype.slice.call(l.groups)),i.push(j))}return i};a.filter=function(e,g){for(var i=e&&e.length?e.length:0,j=[],h=0;h<i;h+=1){g(e[h])&&j.push(e[h])}return j};a.map=function(e,g){var i;if(CKEDITOR.tools.isArray(e)){i=[];for(var j=e.length,h=0;h<j;h+=1){i.push(g(e[h]))}}else{for(j in i={},e){i[j]=g(e[j])}}return i};a.groupButtons=function(g){for(var h={},k=g.length,l=0;l<k;l+=1){var i=g[l],j=i.toolbar.split(",")[0];h[j]=h[j]||[];h[j].push(i)}return h};a.toolbarToButtons=function(e){for(var f=[],g=e.length,h=0;h<g;h+=1){"object"==typeof e[h]&&(f=f.concat(a.groupToButtons(e[h])))}return f};a.createToolbarButton=function(e){var g=new CKEDITOR.dom.element("a"),i=a.createIcon(e.name,e.icon,e.command);g.setStyle("float","none");g.addClass("cke_"+("rtl"==CKEDITOR.lang.dir?"rtl":"ltr"));if(e instanceof CKEDITOR.ui.button){g.addClass("cke_button"),g.addClass("cke_toolgroup"),g.append(i)}else{if(CKEDITOR.ui.richCombo&&e instanceof CKEDITOR.ui.richCombo){var i=new CKEDITOR.dom.element("span"),j=new CKEDITOR.dom.element("span"),h=new CKEDITOR.dom.element("span");g.addClass("cke_combo_button");i.addClass("cke_combo_text");i.addClass("cke_combo_inlinelabel");i.setText(e.label);j.addClass("cke_combo_open");h.addClass("cke_combo_arrow");j.append(h);g.append(i);g.append(j)}}return g};a.createIcon=function(e,f,g){var h=CKEDITOR.skin.getIconStyle(e,"rtl"==CKEDITOR.lang.dir),h=(h=h||CKEDITOR.skin.getIconStyle(f,"rtl"==CKEDITOR.lang.dir))||CKEDITOR.skin.getIconStyle(g,"rtl"==CKEDITOR.lang.dir),f=new CKEDITOR.dom.element("span");f.addClass("cke_button_icon");f.addClass("cke_button__"+e+"_icon");f.setAttribute("style",h);f.setStyle("float","none");return f};a.createButton=function(e,f){var g=new CKEDITOR.dom.element("button");g.addClass("button-a");if("string"==typeof f){for(var f=f.split(" "),h=f.length;h--;){g.addClass(f[h])}}g.setHtml(e);return g};a.groupToButtons=function(e){for(var g=[],i=(e=e.items)?e.length:0,j=0;j<i;j+=1){var h=e[j];if(h instanceof CKEDITOR.ui.button||CKEDITOR.ui.richCombo&&h instanceof CKEDITOR.ui.richCombo){h.$=a.createToolbarButton(h),g.push(h)}}return g}})();