(function(){function g(p){for(var p=p.toUpperCase(),t=f.length,o=0,q=0;q<t;++q){for(var s=f[q],r=s[1].length;p.substr(0,r)==s[1];p=p.substr(r)){o+=s[0]}}return o}function e(p){for(var p=p.toUpperCase(),r=c.length,o=1,q=1;0<p.length;q*=r){o+=c.indexOf(p.charAt(p.length-1))*q,p=p.substr(0,p.length-1)}return o}var b=CKEDITOR.htmlParser.fragment.prototype,d=CKEDITOR.htmlParser.element.prototype;b.onlyChild=d.onlyChild=function(){var o=this.children;return 1==o.length&&o[0]||null};d.removeAnyChildWithName=function(p){for(var s=this.children,o=[],q,r=0;r<s.length;r++){q=s[r],q.name&&(q.name==p&&(o.push(q),s.splice(r--,1)),o=o.concat(q.removeAnyChildWithName(p)))}return o};d.getAncestor=function(o){for(var p=this.parent;p&&(!p.name||!p.name.match(o));){p=p.parent}return p};b.firstChild=d.firstChild=function(p){for(var q,o=0;o<this.children.length;o++){if(q=this.children[o],p(q)||q.name&&(q=q.firstChild(p))){return q}}return null};d.addStyle=function(p,s,o){var q="";if("string"==typeof s){q+=p+":"+s+";"}else{if("object"==typeof p){for(var r in p){p.hasOwnProperty(r)&&(q+=r+":"+p[r]+";")}}else{q+=p}o=s}this.attributes||(this.attributes={});p=this.attributes.style||"";p=(o?[q,p]:[p,q]).join(";");this.attributes.style=p.replace(/^;+|;(?=;)/g,"")};d.getStyle=function(o){var p=this.attributes.style;if(p){return p=CKEDITOR.tools.parseCssText(p,1),p[o]}};CKEDITOR.dtd.parentOf=function(p){var q={},o;for(o in this){-1==o.indexOf("$")&&this[o][p]&&(q[o]=1)}return q};var j=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i,a=/^(?:\b0[^\s]*\s*){1,4}$/,h={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},f=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],c="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0,l=null,i,m=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(p,q){var o=new CKEDITOR.htmlParser.element("cke:listbullet");o.attributes={"cke:listsymbol":p[0]};o.add(new CKEDITOR.htmlParser.text(q));return o},isListBulletIndicator:function(o){if(/mso-list\s*:\s*Ignore/i.test(o.attributes&&o.attributes.style)){return !0}},isContainingOnlySpaces:function(o){var p;return(p=o.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(p.value)},resolveList:function(p){var q=p.attributes,o;if((o=p.removeAnyChildWithName("cke:listbullet"))&&o.length&&(o=o[0])){return p.name="cke:li",q.style&&(q.style=m.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(r){r=r.split(" ");r=CKEDITOR.tools.convertToPx(r[3]||r[1]||r[0]);!n&&(null!==l&&r>l)&&(n=r-l);l=r;q["cke:indent"]=n&&Math.ceil(r/n)+1||1}],[/^mso-list$/,null,function(s){s=s.split(" ");if(!(2>s.length)){var r=Number(s[0].match(/\d+/)),s=Number(s[1].match(/\d+/));1==s&&(r!==i&&(q["cke:reset"]=1),i=r);q["cke:indent"]=s}}]])(q.style,p)||""),q["cke:indent"]||(l=0,q["cke:indent"]=1),CKEDITOR.tools.extend(q,o.attributes),!0}i=l=n=null;return !1},getStyleComponents:function(){var o=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(o);return function(s,p,q){o.setStyle(s,p);for(var s={},p=q.length,r=0;r<p;r++){s[q[r]]=o.getStyle(q[r])}return s}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(x,v){var v="number"==typeof v?v:1,w=x.attributes,s;switch(w.type){case"a":s="lower-alpha";break;case"1":s="decimal"}for(var u=x.children,t,q=0;q<u.length;q++){if(t=u[q],t.name in CKEDITOR.dtd.$listItem){var p=t.attributes,r=t.children,o=r[r.length-1];o.name in CKEDITOR.dtd.$list&&(x.add(o,q+1),--r.length||u.splice(q--,1));t.name="cke:li";w.start&&!q&&(p.value=w.start);m.filters.stylesFilter([["tab-stops",null,function(y){(y=y.split(" ")[1].match(j))&&(l=CKEDITOR.tools.convertToPx(y[0]))}],1==v?["mso-list",null,function(y){y=y.split(" ");y=Number(y[0].match(/\d+/));y!==i&&(p["cke:reset"]=1);i=y}]:null])(p.style);p["cke:indent"]=v;p["cke:listtype"]=x.name;p["cke:list-style-type"]=s}else{if(t.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[t,v+1]);u=u.slice(0,q).concat(t.children).concat(u.slice(q+1));x.children=[];t=0;for(r=u.length;t<r;t++){x.add(u[t])}u=x.children}}}delete x.name;w["cke:list"]=1},assembleList:function(J){for(var H=J.children,I,E,G,F,B,A,J=[],D,x,C,y,z,v,w=0;w<H.length;w++){if(I=H[w],"cke:li"==I.name){if(I.name="li",E=I.attributes,C=(C=E["cke:listsymbol"])&&C.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),y=z=v=null,E["cke:ignored"]){H.splice(w--,1)}else{E["cke:reset"]&&(A=F=B=null);G=Number(E["cke:indent"]);G!=F&&(x=D=null);if(C){if(x&&h[x][D].test(C[1])){y=x,z=D}else{for(var t in h){for(var o in h[t]){if(h[t][o].test(C[1])){if("ol"==t&&/alpha|roman/.test(o)){if(D=/roman/.test(o)?g(C[1]):e(C[1]),!v||D<v){v=D,y=t,z=o}}else{y=t;z=o;break}}}}}!y&&(y=C[2]?"ol":"ul")}else{y=E["cke:listtype"]||"ol",z=E["cke:list-style-type"]}x=y;D=z||("ol"==y?"decimal":"disc");z&&z!=("ol"==y?"decimal":"disc")&&I.addStyle("list-style-type",z);if("ol"==y&&C){switch(z){case"decimal":v=Number(C[1]);break;case"lower-roman":case"upper-roman":v=g(C[1]);break;case"lower-alpha":case"upper-alpha":v=e(C[1])}I.attributes.value=v}if(A){if(G>F){J.push(A=new CKEDITOR.htmlParser.element(y)),A.add(I),B.add(A)}else{if(G<F){F-=G;for(var s;F--&&(s=A.parent);){A=s.parent}}A.add(I)}H.splice(w--,1)}else{J.push(A=new CKEDITOR.htmlParser.element(y)),A.add(I),H[w]=A}B=I;F=G}}else{A&&(A=F=B=null)}}for(w=0;w<J.length;w++){if(A=J[w],t=A.children,D=D=void 0,o=A.children.length,s=D=void 0,H=/list-style-type:(.*?)(?:;|$)/,F=CKEDITOR.plugins.pastefromword.filters.stylesFilter,D=A.attributes,!H.exec(D.style)){for(B=0;B<o;B++){if(D=t[B],D.attributes.value&&Number(D.attributes.value)==B+1&&delete D.attributes.value,D=H.exec(D.attributes.style)){if(D[1]==s||!s){s=D[1]}else{s=null;break}}}if(s){for(B=0;B<o;B++){D=t[B].attributes,D.style&&(D.style=F([["list-style-type"]])(D.style)||"")}A.addStyle("list-style-type",s)}}}i=l=n=null},falsyFilter:function(){return !1},stylesFilter:function(o,p){return function(q,r){var t=[];(q||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(v,A,z){A=A.toLowerCase();"font-family"==A&&(z=z.replace(/["']/g,""));for(var u,y,w,x=0;x<o.length;x++){if(o[x]&&(v=o[x][0],u=o[x][1],y=o[x][2],w=o[x][3],A.match(v)&&(!u||z.match(u)))){A=w||A;p&&(y=y||z);"function"==typeof y&&(y=y(z,r,A));y&&y.push&&(A=y[0],y=y[1]);"string"==typeof y&&t.push([A,y]);return}}!p&&t.push([A,z])});for(var s=0;s<t.length;s++){t[s]=t[s].join(":")}return t.length?t.join(";")+";":!1}},elementMigrateFilter:function(o,p){return o?function(q){var r=p?(new CKEDITOR.style(o,p))._.definition:o;q.name=r.element;CKEDITOR.tools.extend(q.attributes,CKEDITOR.tools.clone(r.attributes));q.addStyle(CKEDITOR.style.getStyleText(r));r.attributes&&r.attributes["class"]&&(q.classWhiteList=" "+r.attributes["class"]+" ")}:function(){}},styleMigrateFilter:function(p,q){var o=this.elementMigrateFilter;return p?function(s,u){var t=new CKEDITOR.htmlParser.element(null),r={};r[q]=s;o(p,r)(t);t.children=u.children;u.children=[t];t.filter=function(){};t.parent=u}:function(){}},bogusAttrFilter:function(o,p){if(-1==p.name.indexOf("cke:")){return !1}},applyStyleFilter:null},getRules:function(P,N){var O=CKEDITOR.dtd,K=CKEDITOR.tools.extend({},O.$block,O.$listItem,O.$tableContent),M=P.config,L=this.filters,H=L.falsyFilter,G=L.stylesFilter,J=L.elementMigrateFilter,D=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),I=this.utils.createListBulletMarker,E=L.flattenList,F=L.assembleList,A=this.utils.isListBulletIndicator,C=this.utils.isContainingOnlySpaces,z=this.utils.resolveList,v=function(o){o=CKEDITOR.tools.convertToPx(o);return isNaN(o)?o:o+"px"},y=this.utils.getStyleComponents,w=this.utils.listDtdParents,B=!1!==M.pasteFromWordRemoveFontStyles,x=!1!==M.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(o){o.filterChildren(N);F(o)},elements:{"^":function(o){var p;CKEDITOR.env.gecko&&(p=L.applyStyleFilter)&&p(o)},$:function(o){var p=o.name||"",q=o.attributes;p in K&&q.style&&(q.style=G([[/^(:?width|height)$/,null,v]])(q.style)||"");if(p.match(/h\d/)){o.filterChildren(N);if(z(o)){return}J(M["format_"+p])(o)}else{if(p in O.$inline){o.filterChildren(N),C(o)&&delete o.name}else{if(-1!=p.indexOf(":")&&-1==p.indexOf("cke")){o.filterChildren(N);if("v:imagedata"==p){if(p=o.attributes["o:href"]){o.attributes.src=p}o.name="img";return}delete o.name}}}p in w&&(o.filterChildren(N),F(o))},style:function(o){if(CKEDITOR.env.gecko){var o=(o=o.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&o[1],p={};o&&(o.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(r,q,s){for(var q=q.split(","),r=q.length,t=0;t<r;t++){CKEDITOR.tools.trim(q[t]).replace(/^(\w+)(\.[\w-]+)?$/g,function(Q,u,R){u=u||"*";R=R.substring(1,R.length);R.match(/MsoNormal/)||(p[u]||(p[u]={}),R?p[u][R]=s:p[u]=s)})}}),L.applyStyleFilter=function(r){var q=p["*"]?"*":r.name,s=r.attributes&&r.attributes["class"];q in p&&(q=p[q],"object"==typeof q&&(q=q[s]),q&&r.addStyle(q,!0))})}return !1},p:function(p){if(/MsoListParagraph/i.exec(p.attributes["class"])||p.getStyle("mso-list")){var o=p.firstChild(function(q){return q.type==CKEDITOR.NODE_TEXT&&!C(q.parent)});(o=o&&o.parent)&&o.addStyle("mso-list","Ignore")}p.filterChildren(N);z(p)||(M.enterMode==CKEDITOR.ENTER_BR?(delete p.name,p.add(new CKEDITOR.htmlParser.element("br"))):J(M["format_"+(M.enterMode==CKEDITOR.ENTER_P?"p":"div")])(p))},div:function(p){var q=p.onlyChild();if(q&&"table"==q.name){var o=p.attributes;q.attributes=CKEDITOR.tools.extend(q.attributes,o);o.style&&q.addStyle(o.style);q=new CKEDITOR.htmlParser.element("div");q.addStyle("clear","both");p.add(q);delete p.name}},td:function(o){o.getAncestor("thead")&&(o.name="th")},ol:E,ul:E,dl:E,font:function(p){if(A(p.parent)){delete p.name}else{p.filterChildren(N);var o=p.attributes,r=o.style,q=p.parent;"font"==q.name?(CKEDITOR.tools.extend(q.attributes,p.attributes),r&&q.addStyle(r),delete p.name):(r=(r||"").split(";"),o.color&&("#000000"!=o.color&&r.push("color:"+o.color),delete o.color),o.face&&(r.push("font-family:"+o.face),delete o.face),o.size&&(r.push("font-size:"+(3<o.size?"large":3>o.size?"small":"medium")),delete o.size),p.name="span",p.addStyle(r.join(";")))}},span:function(p){if(A(p.parent)){return !1}p.filterChildren(N);if(C(p)){return delete p.name,null}if(A(p)){var o=p.firstChild(function(r){return r.value||"img"==r.name}),q=(o=o&&(o.value||"l."))&&o.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(q){return o=I(q,o),(p=p.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(p.attributes.style)&&(o.attributes["cke:ignored"]=1),o}}if(q=(o=p.attributes)&&o.style){o.style=G([["line-height"],[/^font-family$/,null,!B?D(M.font_style,"family"):null],[/^font-size$/,null,!B?D(M.fontSize_style,"size"):null],[/^color$/,null,!B?D(M.colorButton_foreStyle,"color"):null],[/^background-color$/,null,!B?D(M.colorButton_backStyle,"color"):null]])(q,p)||""}o.style||delete o.style;CKEDITOR.tools.isEmpty(o)&&delete p.name;return null},b:J(M.coreStyles_bold),i:J(M.coreStyles_italic),u:J(M.coreStyles_underline),s:J(M.coreStyles_strike),sup:J(M.coreStyles_superscript),sub:J(M.coreStyles_subscript),a:function(o){o=o.attributes;o.href&&o.href.match(/^file:\/\/\/[\S]+#/i)&&(o.href=o.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(o){o.getAncestor(/h\d/)&&!M.pasteFromWordNumberedHeadingToList&&delete o.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:G(x?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(p,o,q){if(o.name in {p:1,div:1}){o="ltr"==M.contentsLangDirection?"margin-left":"margin-right";if("margin"==q){p=y(q,p,[o])[o]}else{if(q!=o){return null}}if(p&&!a.test(p)){return[o,p]}}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(p,o){if("img"==o.name){return p}}],[/^width|height$/,null,function(p,o){if(o.name in {table:1,td:1,th:1,img:1}){return p}}]]:[[/^mso-/],[/-color$/,null,function(o){if("transparent"==o){return !1}if(CKEDITOR.env.gecko){return o.replace(/-moz-use-text-color/g,"transparent")}}],[/^margin$/,a],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],B?[/font-?/]:null],x),width:function(o,p){if(p.name in O.$tableContent){return !1}},border:function(o,p){if(p.name in O.$tableContent){return !1}},"class":function(p,o){return o.classWhiteList&&-1!=o.classWhiteList.indexOf(" "+p+" ")?p:!1},bgcolor:H,valign:x?H:function(p,o){o.addStyle("vertical-align",p);return !1}},comment:!CKEDITOR.env.ie?function(p,o){var r=p.match(/<img.*?>/),q=p.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return q?(q=(r=q[1]||r&&"l.")&&r.match(/>(?:[(]?)([^\s]+?)([.)]?)</),I(q,r)):CKEDITOR.env.gecko&&r?(r=CKEDITOR.htmlParser.fragment.fromHtml(r[0]).children[0],(q=(q=(q=o.previous)&&q.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&q[1])&&(r.attributes.src=q),r):!1}:H}}},k=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};k.prototype={toHtml:function(o){var o=CKEDITOR.htmlParser.fragment.fromHtml(o),p=new CKEDITOR.htmlParser.basicWriter;o.writeHtml(p,this.dataFilter);return p.getHtml(!0)}};CKEDITOR.cleanWord=function(p,s){p=p.replace(/<!\[([^\]]*?)\]>/g,"<!--[$1]-->");CKEDITOR.env.gecko&&(p=p.replace(/(<\!--\[if[^<]*?\])--\>([\S\s]*?)<\!--(\[endif\]--\>)/gi,"$1$2$3"));CKEDITOR.env.webkit&&(p=p.replace(/(class="MsoListParagraph[^>]+><\!--\[if !supportLists\]--\>)([^<]+<span[^<]+<\/span>)(<\!--\[endif\]--\>)/gi,"$1<span>$2</span>$3"));var o=new k,q=o.dataFilter;q.addRules(CKEDITOR.plugins.pastefromword.getRules(s,q));s.fire("beforeCleanWord",{filter:q});try{p=o.toHtml(p)}catch(r){s.showNotification(s.lang.pastefromword.error)}p=p.replace(/cke:.*?".*?"/g,"");p=p.replace(/style=""/g,"");return p=p.replace(/<span>/g,"")}})();